<script type="text/x-red" data-template-name="createCollaboration">
    <div class="form-row">
        <label for="node-input-box"><i class="fa fa-user"></i> <span data-i18n="box.label.box"></span></label>
        <input type="text" id="node-input-box">
    </div>
    <div class="form-row node-input-urlShare">
        <label for="node-input-urlShare"><i class="fa fa-globe"></i> <span data-i18n="box.label.urlShare"></span></label>
        <input type="text" id="node-input-urlShare" data-i18n="[placeholder]box.placeholder.urlShare">
    </div>
    <div class="form-row node-input-collaborator">
        <label for="node-input-collaborator"><i class="fa fa-envelope"></i> <span data-i18n="box.label.collaborator"></span></label>
        <input type="text" id="node-input-collaborator" data-i18n="[placeholder]box.placeholder.collaborator">
    </div>
    <div class="form-row">
        <label for="node-input-role"><i class="fa fa-edit"></i> <span data-i18n="box.label.role"></label>
        <select id="node-input-role" type="text" text-center style="width: 70%;">
          <option value="editor" default>editor</option>
          <option value="viewer">viewer</option>
          <option value="previewer">previewer</option>
          <option value="uploader">uploader</option>
          <option value="previewer uploader">previewer uploader</option>
          <option value="viewer uploader">viewer uploader</option>
          <option value="co-owner">co-owner</option>
        </select>
      </div> 
  </script>
  
  <script type="text/x-red" data-help-name="createCollaboration">
    <p>Adds a collaboration for single user or multiple users to a file or folder in Box</p>
    <p>The Url Share is taken url of file/folder in note box by the node <code>msg.urlShare</code> property. For example: msg.urlShare = "https://app.box.com/notes/636217384xxx"</p>
    <p>The Collaborator is taken the email address of the users to grant access to the item by the node <code>msg.collaborator</code> property. For example: msg.collaborator = ["user1@gmail.com", "user2@gmail.com"]</p>
    <p>The Role is taken the level of access granted which value is one of "editor", "viewer", "previewer", "uploader", "previewer uploader", "viewer uploader", "co-owner" by the node <code>msg.collaborator</code> property. For example: msg.role = "editor"</p>
    <p>The message sent from the node will have properties:
        <ul>        
          <li><b>payload</b> - return success</li>
        </ul>
    </p>
  </script>
  
  <script type="text/javascript">
    RED.nodes.registerType('createCollaboration',{
        category: 'note-box',
        color:"#C0DEED",
        defaults: {
            box: {type:"box-credentials",required:true},
            urlShare: {value:""},
            collaborator: {value:""},
            role: {value:""}
        },
        inputs:1,
        outputs:1,
        icon: "collaborator.png",
        align: "left",
        label: 'Add Collaboration',
        paletteLabel: 'Add Collaboration',
        oneditprepare: function() {
            document.getElementById('node-config-input-target-opentab').checked = (this.target === 'true');
            document.getElementById('node-config-input-target-openthis').checked = (this.target === 'false');
        },
        oneditsave : function () {
            var t = 'true';
            if (document.getElementById('node-config-input-target-opentab').checked) { t = 'true'; }
            if (document.getElementById('node-config-input-target-openthis').checked) { t = 'false'; }
            this.target = t;
        }
    });
  </script>
  